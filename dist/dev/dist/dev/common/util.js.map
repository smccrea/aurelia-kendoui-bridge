{"version":3,"sources":["common/util.js"],"names":["constants","capitalMatcher","Util","addHyphenAndLower","char","toLowerCase","_hyphenate","name","charAt","slice","replace","_unhyphenate","g","toUpperCase","getBindablePropertyName","propertyName","bindablePrefix","getKendoPropertyName","withoutPrefix","substring","getEventsFromAttributes","element","attributes","Array","prototype","call","events","i","length","attribute","attributeName","startsWith","eventPrefix","hyphenatedEvent","split","withoutTriggerDelegate","camelCased","push","pruneOptions","options","returnOptions","prop","hasValue","fireEvent","data","event","CustomEvent","detail","bubbles","cancelable","dispatchEvent","fireKendoEvent","isTemplateProperty","indexOf","isObject","obj","getChildrenVMs","cssSelector","elements","kendo","jQuery","children","viewModels","each","index","elem","au","controller","viewModel","Error","tagName"],"mappings":"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","file":"common/util.js","sourceRoot":"/source/","sourcesContent":["const capitalMatcher = /([A-Z])/g;\nimport {constants} from './constants';\n\n/**\n* Collection of useful functions used in multiple parts of the plugin\n*/\nexport class Util {\n  /**\n  * prepends hyphen and lowercases the input char\n  * @param char the char to add an hyphen in front for\n  */\n  addHyphenAndLower(char: string): string {\n    return '-' + char.toLowerCase();\n  }\n\n  /**\n  * hyphenates a string\n  * kTest -> k-test\n  * @param name the string to hyphenate\n  */\n  _hyphenate(name: string): string {\n    return (name.charAt(0).toLowerCase() + name.slice(1)).replace(capitalMatcher, this.addHyphenAndLower);\n  }\n\n  /**\n  * unhyphenate's a string\n  * k-test -> kTest\n  */\n  _unhyphenate(name: string): string {\n    return name.replace(/-([a-z])/g, (g) => g[1].toUpperCase());\n  }\n\n  /**\n  * prepends prefix and unhyphenates the resulting string\n  * test -> kTest\n  */\n  getBindablePropertyName(propertyName: string): string {\n    let name = `${constants.bindablePrefix}${propertyName}`;\n\n    return this._unhyphenate(name);\n  }\n\n  /**\n  * removes prefix and unhyphenates the resulting string\n  * kTest -> test\n  */\n  getKendoPropertyName(propertyName: string): string {\n    let withoutPrefix = propertyName.substring(1); // remove 'k'\n\n    return (withoutPrefix.charAt(0).toLowerCase() + withoutPrefix.slice(1));\n  }\n\n  /**\n  * converts all attributes found on an element to matching Kendo events\n  * returns a list of these Kendo events\n  */\n  getEventsFromAttributes(element: Element): string[] {\n    let attributes = Array.prototype.slice.call(element.attributes);\n    let events: string[] = [];\n\n    for (let i = 0; i < attributes.length; i++) {\n      let attribute = attributes[i];\n      let attributeName = attribute.name;\n      if (!attributeName.startsWith(constants.eventPrefix)) continue;\n\n      // kendo-my-event.trigger -> my-event.trigger\n      let hyphenatedEvent = attributeName.split(constants.eventPrefix)[1];\n\n      // my-event.trigger -> my-event\n      let withoutTriggerDelegate = hyphenatedEvent.split('.')[0];\n\n      // my-event -> myEvent\n      let camelCased = this._unhyphenate(withoutTriggerDelegate);\n\n      events.push(camelCased);\n    }\n\n    return events;\n  }\n\n\n  /**\n  * Implicitly setting options to \"undefined\" for a kendo control can break things.\n  * this function prunes the supplied options object and removes values that\n  * aren't set to something explicit (i.e. not null)\n  * @param options the options object to prune the properties of\n  */\n  pruneOptions(options: any) {\n    let returnOptions = {};\n\n    for (let prop in options) {\n      if (this.hasValue(options[prop])) {\n        returnOptions[prop] = options[prop];\n      }\n    }\n\n    return returnOptions;\n  }\n\n  hasValue(prop) {\n    return typeof(prop) !== 'undefined' && prop !== null;\n  }\n\n  /**\n  * Fire DOM event on an element\n  * @param element The Element which the DOM event will be fired on\n  * @param name The Event's name\n  * @param data Addition data to attach to an event\n  */\n  fireEvent(element: Element, name: string, data = {}) {\n    let event = new CustomEvent(name, {\n      detail: data,\n      bubbles: true,\n      cancelable: true\n    });\n    element.dispatchEvent(event);\n\n    return event;\n  }\n\n  /**\n  * Fire DOM event on an element with the k-on prefix\n  * @param element The Element which the DOM event will be fired on\n  * @param name The Event's name, without k-on prefix\n  * @param data Addition data to attach to an event\n  */\n  fireKendoEvent(element: Element, name: string, data = {}) {\n    return this.fireEvent(element, `${constants.eventPrefix}${name}`, data);\n  }\n\n  /**\n  * detection of template properties\n  */\n  isTemplateProperty(propertyName: string) {\n    return propertyName.toLowerCase().indexOf('template') > -1;\n  }\n\n  /**\n  * detection of objects\n  */\n  isObject(obj) {\n    return obj !== null && typeof(obj) === 'object';\n  }\n\n  getChildrenVMs(element, cssSelector) {\n    let elements = kendo.jQuery(element).children(cssSelector);\n    let viewModels = [];\n    elements.each((index, elem) => {\n      if (elem.au && elem.au.controller) {\n        viewModels.push(elem.au.controller.viewModel);\n      } else {\n        throw new Error(`au property not found on element ${elem.tagName}. Did you load this custom element via <require> or via main.js?`);\n      }\n    });\n    return viewModels;\n  }\n}\n"]}